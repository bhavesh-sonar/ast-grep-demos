id: anonymous-ldap-bind
language: Kotlin
message: Detected anonymous LDAP bind.
    This permits anonymous users to execute LDAP statements

rule:
   kind: call_expression
   pattern: $ABC
   all:
       - has:
             stopBy: end
             kind: navigation_expression
             has: 
               stopBy: end
               kind: simple_identifier
               pattern: $ENV
       - inside:
            stopBy: end
            kind: function_body
            has:
                stopBy: end
                kind: string_literal
                pattern: $NONE
                regex: none


fix:
  $ENV.put(Context.SECURITY_AUTHENTICATION, "simple")